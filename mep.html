<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>¬øSan Valent√≠n?</title>

<style>
body{
    margin:0;
    overflow:hidden;
    background:black;
    font-family:Arial, sans-serif;
}

h1{
    position:absolute;
    top:8%;
    width:100%;
    text-align:center;
    color:white;
}

#yesBtn{
    position:absolute;
    bottom:18%;
    left:50%;
    transform:translateX(-50%);
    padding:12px 25px;
    font-size:18px;
    border:none;
    border-radius:20px;
    background:#ff4e88;
    color:white;
    cursor:pointer;
}

#noBtn{
    position:absolute;
    left:50%;
    top:50%;
    transform:translate(-50%, -50%);
    padding:10px 20px;
    border:none;
    border-radius:20px;
    background:red;
    color:white;
    font-weight:bold;
    cursor:pointer;
}

.arrow{
    position:absolute;
    width:30px;
    height:5px;
    background:white;
}

#message{
    position:absolute;
    bottom:8%;
    width:100%;
    text-align:center;
    color:white;
    font-size:18px;
}
</style>
</head>

<body>

<h1>¬øQuer√©s ser mi San Valent√≠n? üíò</h1>

<button id="yesBtn" onclick="win()">S√≠ üíï</button>
<button id="noBtn">No ‚ù§Ô∏è</button>

<div id="message"></div>

<audio id="battleMusic" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_3f0d6a02b6.mp3?filename=battle-110624.mp3" type="audio/mpeg">
</audio>

<script>
const noBtn = document.getElementById("noBtn");
const messageDiv = document.getElementById("message");
const music = document.getElementById("battleMusic");

let battleStarted = false;
let arrowInterval = null;
let animationRunning = true;

const isMobile = /Mobi|Android/i.test(navigator.userAgent);

let velX = isMobile ? 2 : 4;
let velY = isMobile ? 2 : 4;

let posX = window.innerWidth/2;
let posY = window.innerHeight/2;

const messages = [
"Creo que te equivocaste... el correcto es el 'S√≠' üòè",
"Ups‚Ä¶ bot√≥n incorrecto üòå",
"Error 404: El 'No' no existe üíò",
"Eso no estaba en el gui√≥n üëÄ",
"Te est√°s haciendo dif√≠cil eh üòè",
"El universo dice que es 'S√≠' ‚ú®",
"Recalculando decisi√≥n... ‚ù§Ô∏è",
"Bot√≥n bloqueado emocionalmente üíï",
"Eso fue un reflejo involuntario üòÖ",
"Te doy otra oportunidad üòå",
"Claramente era el otro bot√≥n üòé",
"Intento interesante ü§®",
"No funciona ese, prob√° el rosa üíò",
"El destino ya eligi√≥ por vos üòå",
"Conf√≠o en que apretar√°s el correcto üòè",
"El rojo es decorativo nom√°s ‚ù§Ô∏è",
"¬øSeguro? Pensalo mejor üòé",
"Te observo... elige sabiamente üëÄ",
"El amor no acepta 'No' üòå",
"Intent√° otra vez campe√≥n üòé"
];

noBtn.addEventListener("click", () => {

    const randomIndex = Math.floor(Math.random() * messages.length);
    messageDiv.textContent = messages[randomIndex];

    if(!battleStarted){
        startBattle();
        battleStarted = true;
    }
});

function startBattle(){
    music.play();

    function moveHeart(){
        if(!animationRunning) return;

        posX += velX;
        posY += velY;

        if(posX <= 0 || posX >= window.innerWidth - noBtn.offsetWidth){
            velX *= -1;
        }

        if(posY <= 0 || posY >= window.innerHeight - noBtn.offsetHeight){
            velY *= -1;
        }

        noBtn.style.left = posX + "px";
        noBtn.style.top = posY + "px";

        requestAnimationFrame(moveHeart);
    }

    moveHeart();
    arrowInterval = setInterval(shootArrow, 600);
}

function shootArrow(){

    const arrow = document.createElement("div");
    arrow.classList.add("arrow");

    const side = Math.floor(Math.random()*4);

    let arrowX, arrowY, speedX, speedY;

    if(side === 0){
        arrowX = 0;
        arrowY = Math.random()*window.innerHeight;
        speedX = 6; speedY = 0;
    }
    else if(side === 1){
        arrowX = Math.random()*window.innerWidth;
        arrowY = 0;
        speedX = 0; speedY = 6;
    }
    else if(side === 2){
        arrowX = 0;
        arrowY = 0;
        speedX = 5; speedY = 5;
    }
    else{
        arrowX = window.innerWidth;
        arrowY = 0;
        speedX = -5; speedY = 5;
    }

    arrow.style.left = arrowX + "px";
    arrow.style.top = arrowY + "px";
    document.body.appendChild(arrow);

    function moveArrow(){
        arrowX += speedX;
        arrowY += speedY;
        arrow.style.left = arrowX + "px";
        arrow.style.top = arrowY + "px";

        if(
            arrowX > window.innerWidth ||
            arrowY > window.innerHeight ||
            arrowX < 0
        ){
            arrow.remove();
            return;
        }

        requestAnimationFrame(moveArrow);
    }

    moveArrow();
}

function win(){

    // Detener animaciones
    animationRunning = false;

    // Detener flechas
    clearInterval(arrowInterval);

    // Eliminar flechas existentes
    document.querySelectorAll(".arrow").forEach(a => a.remove());

    // Pausar m√∫sica
    music.pause();
    music.currentTime = 0;

    // Pantalla final
    document.body.innerHTML = `
    <div style="display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;background:#ff8fab;color:white;text-align:center;">
        <h2>Este soy yo haciendo esto</h2>
        <img src="https://media.giphy.com/media/JIX9t2j0ZTN9S/giphy.gif" width="250">
        <h1>Sab√≠a que dir√≠as que s√≠ üòéüíï</h1>
    </div>
    `;
}
</script>

</body>
</html>